<script type="text/javascript">
var OBJ_LIST = ['account','management']
var ORIGINAL_OBJ_DATA = {}
var MODIFIED_OBJ_DATA = {}
</script>
<form id="ui-form">
<table class="table table-info password_zone">
<tbody>
<tr id="tr_passwd" >
<td>
<span class="multi_lang" id="lang_passwd_title"></span>
</td>
<td>
<input maxlength="63" type='password' value="" name="account.AccountT[0].password" id="passwd" onblur="" size="17" class="logger_bot">
</td>
</tr>
<tr id="tr_passwd_confirm" >
<td>
<span class="multi_lang" id="lang_passwd_confirm_title"></span>
</td>
<td>
<input maxlength="63" type='password' value="" name="passwd_confirm" id="passwd_confirm" onblur="" size="17" class="logger_bot">
</td>
</tr>
</tbody>
</table>
</form>
<div class="form-actions">
<button class="btn btn-primary multi_lang logger_bot" id="btnSave" type="button" name="" onclick="valid_passwd()"></button>
<button class="btncancel multi_lang logger_bot" id="btnCancel" type="button" name="" onclick="page_cancel()"></button>
</div>
<script language="javascript" type="text/javascript">

page_tag='administration_password'

var SVAE_RD_FLAG=0
$(document).ready(function(){
$.lang_load("administration_password");
$.lang_load("error_message");
page_initial()
inject_log_bot()
escape_detection()
});

function valid_passwd(){
var pw=$("#passwd").val()
var pwc=$("#passwd_confirm").val()
if( ORIGINAL_OBJ_DATA.account.AccountT[0].password == pw ){
show_alert(L.common.lang_info_title,L.error_message.lang_error_message_err109)
return;
}
else if( pw == "" ){
alert(L.error_message.lang_error_message_err6);
return;
}
else if( ! check_contain_space(pw) ){
alert(L.administration_password.lang_passwd_title + " " + L.error_message.lang_error_message_contain_space);
return;
}
else if( ! valid_ascii(pw) ){
alert(L.error_message.lang_error_message_err29);
return;
}
else if( pw != pwc ){
alert(L.administration_password.lang_passwd_confirm_error);
return;
}
else{
if(pw=="admin")
MODIFIED_OBJ_DATA.management.ManagementP.remoteEnable = "0";
$('#loader').show();
SVAE_RD_FLAG=1
page_save()
}
}

function set_obj_success_cb(obj) {
if(obj.api_return != 0){
set_obj_error_cb(obj)
return;
}
$("#loader").hide()
show_alert(L.common.success_title, L.common.save_success)
setTimeout(function(){
logout('')
},1000);
}
function set_obj_error_cb(obj) {
$("#loader").hide()
if(obj.api_return == 403){
logout('sto')
return;
}else{
show_alert(L.common.fail_title, L.common.save_fail)
}
}
function set_obj_data(obj_content){
if(typeof(obj_content) == 'string')
API.obj.set(JSON.parse(obj_content), set_obj_success_cb, set_obj_error_cb);
else if(typeof(obj_content) == 'object')
API.obj.set(obj_content, set_obj_success_cb, set_obj_error_cb);
}
function page_save(fake_action){
var obj = UI.form.toObj('ui-form');
MODIFIED_OBJ_DATA = UI.obj.merge(MODIFIED_OBJ_DATA, obj);

delete MODIFIED_OBJ_DATA.passwd_confirm

if( 'undefined' == typeof(fake_action) || !fake_action){
set_obj_data(MODIFIED_OBJ_DATA)
}
}
function page_cancel(){
UI.obj.toForm(ORIGINAL_OBJ_DATA, 'ui-form');
if( "" != $("#passwd").val() ){
$("#passwd_confirm").val($("#passwd").val())
}
//Coding cancel function here
}
function get_obj_success_cb(obj) {
if(obj.api_return != 0){
get_obj_error_cb(obj)
return;
}
ORIGINAL_OBJ_DATA = API.obj.copy(obj);
MODIFIED_OBJ_DATA = API.obj.copy(ORIGINAL_OBJ_DATA);
UI.obj.toForm(MODIFIED_OBJ_DATA, 'ui-form');
if( "" != $("#passwd").val() ){
$("#passwd_confirm").val($("#passwd").val())
}
}
function get_obj_error_cb(obj) {
if(obj.api_return == 403){
logout('sto')
return;
}
}
function get_obj_data(obj_list){
API.obj.get(obj_list, get_obj_success_cb, get_obj_error_cb);
}
function page_initial(){
//Coding initial function here
get_obj_data(OBJ_LIST)
}

function escape_modified_check(){
if(SVAE_RD_FLAG == 1){
return false
}else{
page_save(true)
if(UI.obj.cmp(MODIFIED_OBJ_DATA,ORIGINAL_OBJ_DATA))
return false
else
return true
}

}


</script>


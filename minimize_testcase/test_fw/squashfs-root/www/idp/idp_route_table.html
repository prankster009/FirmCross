<!DOCTYPE html>
<HTML >
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title></title>
<meta http-equiv="expires" content="0">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link rel="stylesheet" href="/css/all.min.css">
<script src="/js/all.min.js"></script>
<style>
body { display: initial }
.col-md-right { overflow: auto; float: none; height: auto }
body{
background-color: white;
display: block;
}
</style>
</HEAD>
<BODY onload="init()" onpageshow="resizePopout()">
<form method="post" action="" name="route_table">

<div class="pop-modal">
<div class="modal-header">
<button class="close logger_bot" type="button" onclick="closePopout()">&#215;</button>
<h3><span class="multi_lang" id="lang_idp_route_table_title"></span></h3>
</div>
<div class="modal-body">
<table class="table table-info-bg table-bordered">
<thead>
<tr>
<td><span class="multi_lang" id="lang_idp_route_table_dst_ip_title"></span></td>
<td><span class="multi_lang" id="lang_idp_route_table_subnet_mask_title"></span></td>
<td><span class="multi_lang" id="lang_idp_route_table_gateway_title"></span></td>
<td><span class="multi_lang" id="lang_idp_route_table_hop_count_title"></span></td>
<td><span class="multi_lang" id="lang_idp_route_table_interface_title"></span></td>
</tr>
</thead>
<tbody id="route_table_content"></tbody>
</table>
</div>
</div>

<div class="modal-footer">
<button type="button" data-dismiss="modal" class="btn multi_lang logger_bot" onclick="refresh()" id="btnRefresh"></button>
<button type="button" data-dismiss="modal" class="btncancel multi_lang logger_bot" onclick="closePopout()" id="btnCancel"></button>
</div>
<script type="text/javascript">
//document.title = 'xxxxx';

var INFO_LIST=['showRouteT'];
var INFO_DATA={};
var L;
var table=new Array();

function init()
{
setTimeout(function(){
L = eval('window.parent.L.'+localStorage.iframe_idp_name)
$('#loader', window.parent.document).hide();

get_info_data(INFO_LIST);
inject_log_bot_idp()
},1000);
}

function AAA(dst_ip,mask,gateway,hop,iface) {
this.dst_ip = dst_ip;
this.mask = mask;
this.gateway = gateway;
this.hop = hop;
this.iface = iface;
}

function get_table(obj) {
var i;

for (i=0; i < obj.showRouteT.length; ++i) {
table[i] = new AAA(obj.showRouteT[i].dest,
obj.showRouteT[i].mask,
obj.showRouteT[i].gw,
obj.showRouteT[i].hopn,
obj.showRouteT[i].if);
}
//table[0] = new AAA('192.168.1.0','255.255.255.0','0.0.0.0','1','LAN');
//table[1] = new AAA('10.5.162.0','255.255.254.0','0.0.0.0','1','WAN');
//table[2] = new AAA('0.0.0.0','0.0.0.0','10.5.163.254','1','WAN');
}

function refresh() {
closePopout();
window.parent.open_routing_table();
}

function update_routing_table() {
var table_content="";

for (var i=0; i < table.length; ++i) {
table_content= table_content + '<tr>'
table_content= table_content + '<td>' + table[i].dst_ip + '</td>'
table_content= table_content + '<td>' + table[i].mask + '</td>'
table_content= table_content + '<td>' + table[i].gateway + '</td>'
table_content= table_content + '<td>' + table[i].hop + '</td>'

if (table[i].iface == "wan")
table_content= table_content + '<td>' + L.lang_idp_route_table_interface_wan_tilte + '</td>'
else
table_content= table_content + '<td>' + L.lang_idp_route_table_interface_lan_tilte + '</td>'
table_content= table_content + '</tr>'

}
$("#route_table_content").html(table_content)
resizePopout();
inject_log_bot_idp()
}

function get_info_success_cb(obj) {
INFO_DATA = API.obj.copy(obj);

get_table(INFO_DATA);
update_routing_table();
}
function get_info_error_cb(obj) {
if (obj.api_return == 403) {
logout('sto')
}
}
function get_info_data(info_list) {
API.info.get(info_list, get_info_success_cb, get_info_error_cb);
}

</script>

</FORM></BODY></HTML>
